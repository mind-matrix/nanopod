<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <x-pod>
        <style>
            h2 {
                color: red;
            }
        </style>
        <link rel="stylesheet" href="./global.css">
        <h2>Sandbox 1 says</h2>
        <h3>Hello World</h3>
        <script>
            console.log("Hi from x-pod 1.0", document.body)
        </script>
    </x-pod>

    <x-pod>
        <style>
            h2 {
                color: green;
            }
        </style>
        <link rel="stylesheet" href="./global.css">
        <h2>Sandbox 2 says</h2>
        <h3>Gello World</h3>
        <script>
            console.log("Hi from x-pod 2.0", document.body)
        </script>
    </x-pod>

    <script defer>
        function __uid__(placeholder) {
            return placeholder ? (placeholder ^ Math.random() * 16 >> placeholder / 4).toString(16) : ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, __uid__)
        }

        function __scope__(css, prefix) {
            return prefix + " " + css.trim()
        }
        customElements.define('x-pod', class extends HTMLElement {
            constructor() {
                super()
                let root = this.attachShadow({
                    mode: "closed"
                })
                this.id = "xpod_" + __uid__().substring(0, 8).replace(/\-/g, "")
                root.appendChild(document.createElement("slot"))
                for (let style of this.querySelectorAll("style")) {
                    style.innerHTML = __scope__(style.innerHTML, "#" + this.id)
                }
            }
        })
    </script>
</body>

</html>